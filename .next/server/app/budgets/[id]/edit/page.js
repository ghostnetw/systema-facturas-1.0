(()=>{var e={};e.id=172,e.ids=[172],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},14067:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>o});var i=s(7025),r=s(18198),a=s(82576),n=s.n(a),l=s(45239),d={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>l[e]);s.d(t,d);let o={children:["",{children:["budgets",{children:["[id]",{children:["edit",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,59947)),"C:\\Users\\admin\\Downloads\\facturacion\\app\\budgets\\[id]\\edit\\page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,59650)),"C:\\Users\\admin\\Downloads\\facturacion\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,4540,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,53117,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,6874,23)),"next/dist/client/components/unauthorized-error"]}]}.children,c=["C:\\Users\\admin\\Downloads\\facturacion\\app\\budgets\\[id]\\edit\\page.tsx"],u={require:s,loadChunk:()=>Promise.resolve()},p=new i.AppPageRouteModule({definition:{kind:r.RouteKind.APP_PAGE,page:"/budgets/[id]/edit/page",pathname:"/budgets/[id]/edit",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},24461:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>g});var i=s(45781),r=s(44238),a=s(14784),n=s(14132),l=s(43030),d=s(63352),o=s(5469),c=s(13072),u=s(7439),p=s(4915),m=s(52127),x=s(73583),h=s(28328),v=s.n(h);function g({params:e}){let t=(0,u.useRouter)(),{clients:s,getBudgetById:h,updateBudget:g}=(0,o.U)(),[j,f]=(0,c.useState)({client:"",date:new Date().toISOString().split("T")[0],validUntil:"",items:[{id:1,description:"",quantity:1,price:0,tax:21}],notes:""}),b=async i=>{i.preventDefault();try{let i=s.find(e=>e.id.toString()===j.client);if(!i){p.oR.error("Cliente no seleccionado");return}let r=j.items.reduce((e,t)=>e+t.quantity*t.price,0),a=j.items.reduce((e,t)=>e+t.quantity*t.price*t.tax/100,0),n=r+a,l={client:i.name,cif:i.cif,amount:r.toFixed(2),tax:a.toFixed(2),total:n.toFixed(2),validUntil:new Date(j.validUntil).toLocaleDateString("es-ES"),items:j.items,notes:j.notes};g(e.id,l),p.oR.success("Presupuesto actualizado correctamente"),t.push("/budgets")}catch(e){p.oR.error("Error al actualizar el presupuesto")}};return(0,i.jsx)(m.b,{children:(0,i.jsxs)("div",{className:"flex flex-1 flex-col gap-4 p-4 md:gap-8 md:p-8",children:[(0,i.jsxs)("div",{className:"flex items-center gap-4",children:[(0,i.jsx)(r.$,{variant:"outline",size:"icon",asChild:!0,children:(0,i.jsx)(v(),{href:"/budgets",children:(0,i.jsx)(x.A,{className:"h-4 w-4"})})}),(0,i.jsx)("h1",{className:"text-2xl font-bold",children:"Editar Presupuesto"})]}),(0,i.jsx)("form",{onSubmit:b,children:(0,i.jsxs)(a.Zp,{children:[(0,i.jsxs)(a.aR,{children:[(0,i.jsx)(a.ZB,{children:"Detalles del Presupuesto"}),(0,i.jsx)(a.BT,{children:"Modifica los datos del presupuesto"})]}),(0,i.jsxs)(a.Wu,{className:"space-y-6",children:[(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(l.J,{htmlFor:"client",children:"Cliente"}),(0,i.jsxs)("select",{title:"Select a client",id:"client",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2",value:j.client,onChange:e=>f({...j,client:e.target.value}),required:!0,children:[(0,i.jsx)("option",{value:"",children:"Selecciona un cliente"}),s.map(e=>(0,i.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(l.J,{htmlFor:"validUntil",children:"V\xe1lido hasta"}),(0,i.jsx)(n.p,{id:"validUntil",type:"date",value:j.validUntil,onChange:e=>f({...j,validUntil:e.target.value}),required:!0})]})]}),(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsx)(l.J,{children:"Conceptos"}),j.items.map((e,t)=>(0,i.jsxs)("div",{className:"grid grid-cols-12 gap-4",children:[(0,i.jsx)("div",{className:"col-span-6",children:(0,i.jsx)(n.p,{placeholder:"Descripci\xf3n",value:e.description,onChange:e=>{let s=[...j.items];s[t].description=e.target.value,f({...j,items:s})}})}),(0,i.jsx)("div",{className:"col-span-2",children:(0,i.jsx)(n.p,{type:"number",placeholder:"Cantidad",value:e.quantity,onChange:e=>{let s=[...j.items];s[t].quantity=Number(e.target.value),f({...j,items:s})}})}),(0,i.jsx)("div",{className:"col-span-1",children:(0,i.jsx)(n.p,{type:"number",step:"0.01",placeholder:"Precio",value:e.price,onChange:e=>{let s=[...j.items];s[t].price=Number(e.target.value),f({...j,items:s})}})}),(0,i.jsx)("div",{className:"col-span-1",children:(0,i.jsx)(n.p,{type:"number",step:"1",min:"0",max:"100",placeholder:"IVA %",value:e.tax,onChange:e=>{let s=[...j.items];s[t].tax=Number(e.target.value),f({...j,items:s})}})}),(0,i.jsx)("div",{className:"col-span-1 flex items-center",children:(0,i.jsx)(r.$,{type:"button",variant:"destructive",size:"sm",onClick:()=>{let e=j.items.filter((e,s)=>s!==t);f({...j,items:e})},children:"\xd7"})})]},t)),(0,i.jsx)(r.$,{type:"button",variant:"outline",onClick:()=>{let e=Math.max(0,...j.items.map(e=>e.id))+1;f({...j,items:[...j.items,{id:e,description:"",quantity:1,price:0,tax:21}]})},children:"A\xf1adir concepto"})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(l.J,{htmlFor:"notes",children:"Notas"}),(0,i.jsx)(d.T,{id:"notes",value:j.notes,onChange:e=>f({...j,notes:e.target.value}),placeholder:"A\xf1ade notas o condiciones adicionales"})]})]}),(0,i.jsx)(a.wL,{children:(0,i.jsx)(r.$,{type:"submit",children:"Guardar Cambios"})})]})})]})})}},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},35197:(e,t,s)=>{Promise.resolve().then(s.bind(s,59947))},59947:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});let i=(0,s(51129).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\admin\\\\Downloads\\\\facturacion\\\\app\\\\budgets\\\\[id]\\\\edit\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\admin\\Downloads\\facturacion\\app\\budgets\\[id]\\edit\\page.tsx","default")},62813:(e,t,s)=>{Promise.resolve().then(s.bind(s,24461))},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),i=t.X(0,[550,328,915,593,969],()=>s(14067));module.exports=i})();
(()=>{var e={};e.id=194,e.ids=[194],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3905:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\admin\\\\Desktop\\\\facturaciondev2.0\\\\facturacion2.0\\\\app\\\\budgets\\\\new\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\admin\\Desktop\\facturaciondev2.0\\facturacion2.0\\app\\budgets\\new\\page.tsx","default")},4071:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>g});var s=r(60687),i=r(24934),n=r(55192),a=r(68988),o=r(39390),l=r(15616),c=r(27553),d=r(43210),u=r(16189),p=r(52581),m=r(83544),x=r(28559),h=r(85814),v=r.n(h);function g(){let e=(0,u.useRouter)(),{clients:t,addBudget:r,addInvoice:h}=(0,c.U)(),[g,f]=(0,d.useState)({client:"",date:new Date().toISOString().split("T")[0],validUntil:"",items:[{id:1,description:"",quantity:1,price:0,tax:21}],notes:""}),j=async s=>{s.preventDefault();try{let s=t.find(e=>e.id.toString()===g.client);if(!s){p.oR.error("Cliente no seleccionado");return}let i=g.items.reduce((e,t)=>e+t.quantity*t.price,0),n=g.items.reduce((e,t)=>e+t.quantity*t.price*t.tax/100,0),a=i+n,o={id:crypto.randomUUID(),client:s.name,cif:s.cif,amount:i.toFixed(2),tax:n.toFixed(2),total:a.toFixed(2),status:"Pendiente",date:new Date().toLocaleDateString("es-ES"),validUntil:new Date(g.validUntil).toLocaleDateString("es-ES"),items:g.items,notes:g.notes};r(o),p.oR.success("Presupuesto creado correctamente"),e.push("/budgets")}catch(e){p.oR.error("Error al crear el presupuesto")}},b=async()=>{try{if(!g.client||0===g.items.length){p.oR.error("Por favor, completa todos los campos necesarios");return}let r=t.find(e=>e.id.toString()===g.client);if(!r){p.oR.error("Cliente no seleccionado");return}let s=g.items.reduce((e,t)=>e+t.quantity*t.price,0),i=g.items.reduce((e,t)=>e+t.quantity*t.price*t.tax/100,0),n=s+i,a={id:crypto.randomUUID(),client:r.name,cif:r.cif,amount:s.toFixed(2),tax:i.toFixed(2),total:n.toFixed(2),status:"Pendiente",date:new Date().toLocaleDateString("es-ES"),dueDate:new Date(Date.now()+2592e6).toLocaleDateString("es-ES"),items:g.items};h(a),p.oR.success("Presupuesto convertido a factura correctamente"),e.push("/invoices")}catch(e){console.error("Error al convertir el presupuesto:",e),p.oR.error("Error al convertir el presupuesto")}};return(0,s.jsx)(m.b,{children:(0,s.jsxs)("div",{className:"flex flex-1 flex-col gap-4 p-4 md:gap-8 md:p-8",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)(i.$,{variant:"outline",size:"icon",asChild:!0,children:(0,s.jsx)(v(),{href:"/budgets",children:(0,s.jsx)(x.A,{className:"h-4 w-4"})})}),(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"Nuevo Presupuesto"})]}),(0,s.jsx)("form",{onSubmit:j,children:(0,s.jsxs)(n.Zp,{children:[(0,s.jsxs)(n.aR,{children:[(0,s.jsx)(n.ZB,{children:"Detalles del Presupuesto"}),(0,s.jsx)(n.BT,{children:"Introduce los datos del presupuesto"})]}),(0,s.jsxs)(n.Wu,{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(o.J,{htmlFor:"client",children:"Cliente"}),(0,s.jsxs)("select",{title:"Select a client",id:"client",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2",value:g.client,onChange:e=>f({...g,client:e.target.value}),required:!0,children:[(0,s.jsx)("option",{value:"",children:"Selecciona un cliente"}),t.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(o.J,{htmlFor:"validUntil",children:"V\xe1lido hasta"}),(0,s.jsx)(a.p,{id:"validUntil",type:"date",value:g.validUntil,onChange:e=>f({...g,validUntil:e.target.value}),required:!0})]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)(o.J,{children:"Conceptos"}),g.items.map((e,t)=>(0,s.jsxs)("div",{className:"grid grid-cols-12 gap-4",children:[(0,s.jsx)("div",{className:"col-span-6",children:(0,s.jsx)(a.p,{placeholder:"Descripci\xf3n",value:e.description,onChange:e=>{let r=[...g.items];r[t].description=e.target.value,f({...g,items:r})}})}),(0,s.jsx)("div",{className:"col-span-2",children:(0,s.jsx)(a.p,{type:"number",placeholder:"Cantidad",value:e.quantity,onChange:e=>{let r=[...g.items];r[t].quantity=Number(e.target.value),f({...g,items:r})}})}),(0,s.jsx)("div",{className:"col-span-1",children:(0,s.jsx)(a.p,{type:"number",step:"0.01",placeholder:"Precio",value:e.price,onChange:e=>{let r=[...g.items];r[t].price=Number(e.target.value),f({...g,items:r})}})}),(0,s.jsx)("div",{className:"col-span-1",children:(0,s.jsx)(a.p,{type:"number",step:"1",min:"0",max:"100",placeholder:"IVA %",value:e.tax,onChange:e=>{let r=[...g.items];r[t].tax=Number(e.target.value),f({...g,items:r})}})}),(0,s.jsx)("div",{className:"col-span-1 flex items-center",children:(0,s.jsx)(i.$,{type:"button",variant:"destructive",size:"sm",onClick:()=>{let e=g.items.filter((e,r)=>r!==t);f({...g,items:e})},children:"\xd7"})})]},t)),(0,s.jsx)(i.$,{type:"button",variant:"outline",onClick:()=>{let e=Math.max(0,...g.items.map(e=>e.id))+1;f({...g,items:[...g.items,{id:e,description:"",quantity:1,price:0,tax:21}]})},children:"A\xf1adir concepto"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(o.J,{htmlFor:"notes",children:"Notas"}),(0,s.jsx)(l.T,{id:"notes",value:g.notes,onChange:e=>f({...g,notes:e.target.value}),placeholder:"A\xf1ade notas o condiciones adicionales"})]})]}),(0,s.jsxs)(n.wL,{className:"flex justify-between",children:[(0,s.jsx)(i.$,{type:"submit",children:"Guardar Presupuesto"}),(0,s.jsx)(i.$,{type:"button",variant:"outline",onClick:b,children:"Convertir a Factura"})]})]})})]})})}},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11435:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>a.a,__next_app__:()=>u,pages:()=>d,routeModule:()=>p,tree:()=>c});var s=r(65239),i=r(48088),n=r(88170),a=r.n(n),o=r(30893),l={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);r.d(t,l);let c={children:["",{children:["budgets",{children:["new",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,3905)),"C:\\Users\\admin\\Desktop\\facturaciondev2.0\\facturacion2.0\\app\\budgets\\new\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,58014)),"C:\\Users\\admin\\Desktop\\facturaciondev2.0\\facturacion2.0\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"]}]}.children,d=["C:\\Users\\admin\\Desktop\\facturaciondev2.0\\facturacion2.0\\app\\budgets\\new\\page.tsx"],u={require:r,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:i.RouteKind.APP_PAGE,page:"/budgets/new/page",pathname:"/budgets/new",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},26145:(e,t,r)=>{Promise.resolve().then(r.bind(r,3905))},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},62593:(e,t,r)=>{Promise.resolve().then(r.bind(r,4071))},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[447,840,814,581,918,702],()=>r(11435));module.exports=s})();
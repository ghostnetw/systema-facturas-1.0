(()=>{var e={};e.id=674,e.ids=[674],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},31715:(e,s,r)=>{Promise.resolve().then(r.bind(r,35931))},33873:e=>{"use strict";e.exports=require("path")},35079:(e,s,r)=>{"use strict";r.r(s),r.d(s,{GlobalError:()=>n.a,__next_app__:()=>x,pages:()=>o,routeModule:()=>u,tree:()=>l});var i=r(65239),a=r(48088),t=r(88170),n=r.n(t),d=r(30893),c={};for(let e in d)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>d[e]);r.d(s,c);let l={children:["",{children:["invoices",{children:["new",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,50105)),"C:\\Users\\admin\\Desktop\\facturaciondev2.0\\facturacion2.0\\app\\invoices\\new\\page.tsx"]}]},{}]},{loading:[()=>Promise.resolve().then(r.bind(r,54005)),"C:\\Users\\admin\\Desktop\\facturaciondev2.0\\facturacion2.0\\app\\invoices\\loading.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,58014)),"C:\\Users\\admin\\Desktop\\facturaciondev2.0\\facturacion2.0\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"]}]}.children,o=["C:\\Users\\admin\\Desktop\\facturaciondev2.0\\facturacion2.0\\app\\invoices\\new\\page.tsx"],x={require:r,loadChunk:()=>Promise.resolve()},u=new i.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/invoices/new/page",pathname:"/invoices/new",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},35931:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>b});var i=r(60687),a=r(43210),t=r(16189),n=r(27553),d=r(24934),c=r(55192),l=r(68988),o=r(39390),x=r(63974),u=r(78377),h=r(96752),p=r(28559),m=r(88233),j=r(96474),v=r(85814),f=r.n(v),g=r(83544),N=r(70333);function b(){let e=(0,t.useRouter)(),{clients:s,addInvoice:r}=(0,n.U)(),[v,b]=(0,a.useState)(null),[C,y]=(0,a.useState)(""),[F,A]=(0,a.useState)(""),[P,S]=(0,a.useState)(""),[w,k]=(0,a.useState)("transfer"),[I,_]=(0,a.useState)(""),[D,R]=(0,a.useState)([{id:1,description:"",price:0,tax:21}]),[$,q]=(0,a.useState)(0),[E,B]=(0,a.useState)(0),[T,V]=(0,a.useState)(0),U=e=>{D.length>1&&(R(D.filter(s=>s.id!==e)),J(D.filter(s=>s.id!==e)))},Z=(e,s,r)=>{let i=D.map(i=>{if(i.id===e){if("price"===s){let e=parseFloat(r)||0;return{...i,[s]:e}}if("tax"===s){let e=parseInt(r)||0;return{...i,[s]:e}}return{...i,[s]:r}}return i});R(i),J(i)},J=e=>{let s=e.reduce((e,s)=>e+s.price,0),r=e.reduce((e,s)=>e+s.price*(s.tax/100),0);q(s),B(r),V(s+r)};return(0,i.jsx)(g.b,{children:(0,i.jsxs)("div",{className:"flex flex-1 flex-col gap-4 p-4 md:gap-8 md:p-8",children:[(0,i.jsxs)("div",{className:"flex items-center gap-4",children:[(0,i.jsx)(d.$,{variant:"outline",size:"icon",asChild:!0,children:(0,i.jsx)(f(),{href:"/invoices",children:(0,i.jsx)(p.A,{className:"h-4 w-4"})})}),(0,i.jsx)("h1",{className:"text-2xl font-bold",children:"Nueva Factura"})]}),(0,i.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,i.jsxs)(c.Zp,{children:[(0,i.jsxs)(c.aR,{children:[(0,i.jsx)(c.ZB,{children:"Datos de Facturaci\xf3n"}),(0,i.jsx)(c.BT,{children:"Informaci\xf3n de tu empresa y del cliente"})]}),(0,i.jsxs)(c.Wu,{className:"space-y-4",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("h3",{className:"text-sm font-medium",children:"Datos de tu empresa"}),(0,i.jsxs)("div",{className:"rounded-md border p-4 bg-gray-50",children:[(0,i.jsx)("p",{className:"font-medium",children:"RESINA ROSARIO, S.L."}),(0,i.jsx)("p",{className:"text-sm text-muted-foreground",children:"CIF: CIF: B19758218"}),(0,i.jsx)("p",{className:"text-sm text-muted-foreground",children:"PLAZA TORRES BELLAS   N\xba4,3-4"}),(0,i.jsx)("p",{className:"text-sm text-muted-foreground",children:"28923 Alcorcon, Madrid"})]})]}),(0,i.jsx)(u.w,{}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("h3",{className:"text-sm font-medium",children:"Datos del cliente"}),(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(o.J,{htmlFor:"client-select",children:"Seleccionar Cliente"}),(0,i.jsxs)(x.l6,{onValueChange:e=>b(Number(e)),children:[(0,i.jsx)(x.bq,{id:"client-select",children:(0,i.jsx)(x.yv,{placeholder:"Seleccionar cliente"})}),(0,i.jsx)(x.gC,{children:s.map(e=>(0,i.jsxs)(x.eb,{value:e.id.toString(),children:[e.name," - ",e.cif]},e.id))})]})]}),v&&(0,i.jsx)("div",{className:"rounded-md border p-4 bg-gray-50",children:(()=>{let e=s.find(e=>e.id===v);return e?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("p",{className:"font-medium",children:e.name}),(0,i.jsxs)("p",{className:"text-sm text-muted-foreground",children:["CIF: ",e.cif]}),(0,i.jsx)("p",{className:"text-sm text-muted-foreground",children:e.address}),(0,i.jsxs)("p",{className:"text-sm text-muted-foreground",children:[e.postalCode," ",e.city,", ",e.province]})]}):null})()})]})]})]})]}),(0,i.jsxs)(c.Zp,{children:[(0,i.jsxs)(c.aR,{children:[(0,i.jsx)(c.ZB,{children:"Detalles de la Factura"}),(0,i.jsx)(c.BT,{children:"Informaci\xf3n general de la factura"})]}),(0,i.jsxs)(c.Wu,{className:"space-y-4",children:[(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(o.J,{htmlFor:"invoice-number",children:"N\xfamero de Factura"}),(0,i.jsx)(l.p,{id:"invoice-number",placeholder:"INV-2023-009",value:C,onChange:e=>y(e.target.value)})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(o.J,{htmlFor:"invoice-date",children:"Fecha de Emisi\xf3n"}),(0,i.jsx)(l.p,{id:"invoice-date",type:"date",value:F,onChange:e=>A(e.target.value)})]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(o.J,{htmlFor:"invoice-due-date",children:"Fecha de Vencimiento"}),(0,i.jsx)(l.p,{id:"invoice-due-date",type:"date",value:P,onChange:e=>S(e.target.value)})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(o.J,{htmlFor:"payment-method",children:"M\xe9todo de Pago"}),(0,i.jsxs)(x.l6,{defaultValue:"transfer",value:w,onValueChange:k,children:[(0,i.jsx)(x.bq,{id:"payment-method",children:(0,i.jsx)(x.yv,{placeholder:"Seleccionar m\xe9todo"})}),(0,i.jsxs)(x.gC,{children:[(0,i.jsx)(x.eb,{value:"transfer",children:"Transferencia Bancaria"}),(0,i.jsx)(x.eb,{value:"cash",children:"Efectivo"}),(0,i.jsx)(x.eb,{value:"card",children:"Tarjeta de Cr\xe9dito"}),(0,i.jsx)(x.eb,{value:"paypal",children:"PayPal"})]})]})]})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(o.J,{htmlFor:"invoice-notes",children:"Notas"}),(0,i.jsx)(l.p,{id:"invoice-notes",placeholder:"Notas adicionales para el cliente",value:I,onChange:e=>_(e.target.value)})]})]})]})]}),(0,i.jsxs)(c.Zp,{children:[(0,i.jsxs)(c.aR,{children:[(0,i.jsx)(c.ZB,{children:"Conceptos"}),(0,i.jsx)(c.BT,{children:"A\xf1ade los servicios o productos a facturar"})]}),(0,i.jsxs)(c.Wu,{children:[(0,i.jsx)("div",{className:"rounded-md border",children:(0,i.jsxs)(h.XI,{children:[(0,i.jsx)(h.A0,{children:(0,i.jsxs)(h.Hj,{children:[(0,i.jsx)(h.nd,{className:"w-[60%]",children:"Descripci\xf3n"}),(0,i.jsx)(h.nd,{children:"Precio (€)"}),(0,i.jsx)(h.nd,{children:"IVA (%)"}),(0,i.jsx)(h.nd,{children:"Total"}),(0,i.jsx)(h.nd,{})]})}),(0,i.jsx)(h.BF,{children:D.map(e=>(0,i.jsxs)(h.Hj,{children:[(0,i.jsx)(h.nA,{children:(0,i.jsx)(l.p,{placeholder:"Descripci\xf3n del servicio o producto",value:e.description,onChange:s=>Z(e.id,"description",s.target.value)})}),(0,i.jsx)(h.nA,{children:(0,i.jsx)(l.p,{type:"number",min:"0",step:"0.01",value:e.price,onChange:s=>Z(e.id,"price",Number.parseFloat(s.target.value))})}),(0,i.jsx)(h.nA,{children:(0,i.jsxs)(x.l6,{value:e.tax.toString(),onValueChange:s=>Z(e.id,"tax",Number.parseInt(s)),children:[(0,i.jsx)(x.bq,{children:(0,i.jsx)(x.yv,{placeholder:"IVA"})}),(0,i.jsxs)(x.gC,{children:[(0,i.jsx)(x.eb,{value:"21",children:"21%"}),(0,i.jsx)(x.eb,{value:"10",children:"10%"}),(0,i.jsx)(x.eb,{value:"4",children:"4%"}),(0,i.jsx)(x.eb,{value:"0",children:"0%"})]})]})}),(0,i.jsxs)(h.nA,{className:"font-medium",children:["€",(e.price*(1+e.tax/100)).toFixed(2)]}),(0,i.jsx)(h.nA,{children:(0,i.jsx)(d.$,{variant:"ghost",size:"icon",onClick:()=>U(e.id),children:(0,i.jsx)(m.A,{className:"h-4 w-4"})})})]},e.id))})]})}),(0,i.jsx)("div",{className:"mt-4",children:(0,i.jsxs)(d.$,{variant:"outline",onClick:()=>{let e={id:D.length+1,description:"",price:0,tax:21};R([...D,e])},children:[(0,i.jsx)(j.A,{className:"mr-2 h-4 w-4"}),"A\xf1adir Concepto"]})})]}),(0,i.jsxs)(c.wL,{className:"flex justify-between",children:[(0,i.jsx)("div",{}),(0,i.jsxs)("div",{className:"space-y-2 text-right",children:[(0,i.jsxs)("div",{className:"text-sm",children:["Subtotal: ",(0,i.jsxs)("span",{className:"font-medium",children:["€",$.toFixed(2)]})]}),(0,i.jsxs)("div",{className:"text-sm",children:["IVA: ",(0,i.jsxs)("span",{className:"font-medium",children:["€",E.toFixed(2)]})]}),(0,i.jsxs)("div",{className:"text-lg font-bold",children:["Total: €",T.toFixed(2)]})]})]})]}),(0,i.jsxs)("div",{className:"flex justify-end gap-4",children:[(0,i.jsx)(d.$,{variant:"outline",asChild:!0,children:(0,i.jsx)(f(),{href:"/invoices",children:"Cancelar"})}),(0,i.jsx)(d.$,{onClick:()=>{if(!C||!F||!P||!v||D.some(e=>!e.description)){(0,N.o)({title:"Error",description:"Por favor, completa todos los campos obligatorios.",variant:"destructive"});return}let i=s.find(e=>e.id===v);if(!i)return;let a=e=>{let[s,r,i]=e.split("-");return`${i}/${r}/${s}`};r({id:C,client:i.name,cif:i.cif,amount:`€${$.toFixed(2)}`,tax:`€${E.toFixed(2)}`,total:`€${T.toFixed(2)}`,status:"Pendiente",date:a(F),dueDate:a(P),items:D,status:"Pendiente"}),(0,N.o)({title:"Factura creada",description:`La factura ${C} ha sido creada correctamente.`}),e.push("/invoices")},children:"Guardar Factura"})]})]})})}},50105:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>i});let i=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\admin\\\\Desktop\\\\facturaciondev2.0\\\\facturacion2.0\\\\app\\\\invoices\\\\new\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\admin\\Desktop\\facturaciondev2.0\\facturacion2.0\\app\\invoices\\new\\page.tsx","default")},55691:(e,s,r)=>{Promise.resolve().then(r.bind(r,50105))},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")}};var s=require("../../../webpack-runtime.js");s.C(e);var r=e=>s(s.s=e),i=s.X(0,[447,840,814,794,162,918,191],()=>r(35079));module.exports=i})();
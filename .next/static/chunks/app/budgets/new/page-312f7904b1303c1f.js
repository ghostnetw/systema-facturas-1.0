(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[194],{4666:(e,t,a)=>{"use strict";a.d(t,{T:()=>l});var s=a(58081),r=a(82149),i=a(87687);let l=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("textarea",{className:(0,i.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...r})});l.displayName="Textarea"},5984:(e,t,a)=>{"use strict";a.d(t,{hO:()=>d,sG:()=>n});var s=a(82149),r=a(54632),i=a(29668),l=a(58081),n=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce((e,t)=>{let a=s.forwardRef((e,a)=>{let{asChild:s,...r}=e,n=s?i.DX:t;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,l.jsx)(n,{...r,ref:a})});return a.displayName=`Primitive.${t}`,{...e,[t]:a}},{});function d(e,t){e&&r.flushSync(()=>e.dispatchEvent(t))}},11251:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(51018).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},13348:(e,t,a)=>{"use strict";a.d(t,{b:()=>n});var s=a(82149),r=a(5984),i=a(58081),l=s.forwardRef((e,t)=>(0,i.jsx)(r.sG.label,{...e,ref:t,onMouseDown:t=>{var a;t.target.closest("button, input, select, textarea")||(null===(a=e.onMouseDown)||void 0===a||a.call(e,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));l.displayName="Label";var n=l},19651:(e,t,a)=>{"use strict";var s=a(54571);a.o(s,"useParams")&&a.d(t,{useParams:function(){return s.useParams}}),a.o(s,"usePathname")&&a.d(t,{usePathname:function(){return s.usePathname}}),a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}})},21107:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(51018).A)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},44536:(e,t,a)=>{Promise.resolve().then(a.bind(a,67401))},48822:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(51018).A)("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]])},57890:(e,t,a)=>{"use strict";a.d(t,{J:()=>o});var s=a(58081),r=a(82149),i=a(13348),l=a(23484),n=a(87687);let d=(0,l.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(i.b,{ref:t,className:(0,n.cn)(d(),a),...r})});o.displayName=i.b.displayName},62544:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(51018).A)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},67401:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>f});var s=a(58081),r=a(5160),i=a(86810),l=a(80900),n=a(57890),d=a(4666),o=a(48388),c=a(82149),u=a(19651),p=a(61773),h=a(18283),m=a(11251),x=a(47950),v=a.n(x);function f(){let e=(0,u.useRouter)(),{clients:t,addBudget:a,addInvoice:x}=(0,o.U)(),[f,y]=(0,c.useState)({client:"",date:new Date().toISOString().split("T")[0],validUntil:"",items:[{id:1,description:"",quantity:1,price:0,tax:21}],notes:""}),b=async s=>{s.preventDefault();try{let s=t.find(e=>e.id.toString()===f.client);if(!s){p.oR.error("Cliente no seleccionado");return}let r=f.items.reduce((e,t)=>e+t.quantity*t.price,0),i=f.items.reduce((e,t)=>e+t.quantity*t.price*t.tax/100,0),l=r+i,n={id:crypto.randomUUID(),client:s.name,cif:s.cif,amount:r.toFixed(2),tax:i.toFixed(2),total:l.toFixed(2),status:"Pendiente",date:new Date().toLocaleDateString("es-ES"),validUntil:new Date(f.validUntil).toLocaleDateString("es-ES"),items:f.items,notes:f.notes};a(n),p.oR.success("Presupuesto creado correctamente"),e.push("/budgets")}catch(e){p.oR.error("Error al crear el presupuesto")}},g=async()=>{try{if(!f.client||0===f.items.length){p.oR.error("Por favor, completa todos los campos necesarios");return}let a=t.find(e=>e.id.toString()===f.client);if(!a){p.oR.error("Cliente no seleccionado");return}let s=f.items.reduce((e,t)=>e+t.quantity*t.price,0),r=f.items.reduce((e,t)=>e+t.quantity*t.price*t.tax/100,0),i=s+r,l={id:crypto.randomUUID(),client:a.name,cif:a.cif,amount:s.toFixed(2),tax:r.toFixed(2),total:i.toFixed(2),status:"Pendiente",date:new Date().toLocaleDateString("es-ES"),dueDate:new Date(Date.now()+2592e6).toLocaleDateString("es-ES"),items:f.items};x(l),p.oR.success("Presupuesto convertido a factura correctamente"),e.push("/invoices")}catch(e){console.error("Error al convertir el presupuesto:",e),p.oR.error("Error al convertir el presupuesto")}};return(0,s.jsx)(h.b,{children:(0,s.jsxs)("div",{className:"flex flex-1 flex-col gap-4 p-4 md:gap-8 md:p-8",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)(r.$,{variant:"outline",size:"icon",asChild:!0,children:(0,s.jsx)(v(),{href:"/budgets",children:(0,s.jsx)(m.A,{className:"h-4 w-4"})})}),(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"Nuevo Presupuesto"})]}),(0,s.jsx)("form",{onSubmit:b,children:(0,s.jsxs)(i.Zp,{children:[(0,s.jsxs)(i.aR,{children:[(0,s.jsx)(i.ZB,{children:"Detalles del Presupuesto"}),(0,s.jsx)(i.BT,{children:"Introduce los datos del presupuesto"})]}),(0,s.jsxs)(i.Wu,{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(n.J,{htmlFor:"client",children:"Cliente"}),(0,s.jsxs)("select",{title:"Select a client",id:"client",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2",value:f.client,onChange:e=>y({...f,client:e.target.value}),required:!0,children:[(0,s.jsx)("option",{value:"",children:"Selecciona un cliente"}),t.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(n.J,{htmlFor:"validUntil",children:"V\xe1lido hasta"}),(0,s.jsx)(l.p,{id:"validUntil",type:"date",value:f.validUntil,onChange:e=>y({...f,validUntil:e.target.value}),required:!0})]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)(n.J,{children:"Conceptos"}),f.items.map((e,t)=>(0,s.jsxs)("div",{className:"grid grid-cols-12 gap-4",children:[(0,s.jsx)("div",{className:"col-span-6",children:(0,s.jsx)(l.p,{placeholder:"Descripci\xf3n",value:e.description,onChange:e=>{let a=[...f.items];a[t].description=e.target.value,y({...f,items:a})}})}),(0,s.jsx)("div",{className:"col-span-2",children:(0,s.jsx)(l.p,{type:"number",placeholder:"Cantidad",value:e.quantity,onChange:e=>{let a=[...f.items];a[t].quantity=Number(e.target.value),y({...f,items:a})}})}),(0,s.jsx)("div",{className:"col-span-1",children:(0,s.jsx)(l.p,{type:"number",step:"0.01",placeholder:"Precio",value:e.price,onChange:e=>{let a=[...f.items];a[t].price=Number(e.target.value),y({...f,items:a})}})}),(0,s.jsx)("div",{className:"col-span-1",children:(0,s.jsx)(l.p,{type:"number",step:"1",min:"0",max:"100",placeholder:"IVA %",value:e.tax,onChange:e=>{let a=[...f.items];a[t].tax=Number(e.target.value),y({...f,items:a})}})}),(0,s.jsx)("div",{className:"col-span-1 flex items-center",children:(0,s.jsx)(r.$,{type:"button",variant:"destructive",size:"sm",onClick:()=>{let e=f.items.filter((e,a)=>a!==t);y({...f,items:e})},children:"\xd7"})})]},t)),(0,s.jsx)(r.$,{type:"button",variant:"outline",onClick:()=>{let e=Math.max(0,...f.items.map(e=>e.id))+1;y({...f,items:[...f.items,{id:e,description:"",quantity:1,price:0,tax:21}]})},children:"A\xf1adir concepto"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(n.J,{htmlFor:"notes",children:"Notas"}),(0,s.jsx)(d.T,{id:"notes",value:f.notes,onChange:e=>y({...f,notes:e.target.value}),placeholder:"A\xf1ade notas o condiciones adicionales"})]})]}),(0,s.jsxs)(i.wL,{className:"flex justify-between",children:[(0,s.jsx)(r.$,{type:"submit",children:"Guardar Presupuesto"}),(0,s.jsx)(r.$,{type:"button",variant:"outline",onClick:g,children:"Convertir a Factura"})]})]})})]})})}},80900:(e,t,a)=>{"use strict";a.d(t,{p:()=>l});var s=a(58081),r=a(82149),i=a(87687);let l=r.forwardRef((e,t)=>{let{className:a,type:r,...l}=e;return(0,s.jsx)("input",{type:r,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...l})});l.displayName="Input"},83427:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(51018).A)("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]])},90018:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(51018).A)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},97938:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(51018).A)("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]])}},e=>{var t=t=>e(e.s=t);e.O(0,[816,950,773,561,497,954,358],()=>t(44536)),_N_E=e.O()}]);